<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test EmailJS - Flores y Detalles</title>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
</head>
<body>
    <h2>üß™ Test de Configuraci√≥n EmailJS</h2>
    <div id="status">Preparando test...</div>
    <button onclick="testEmailJS()" id="testBtn">Probar Env√≠o de Email</button>

    <script>
        // Configuraci√≥n de EmailJS (debe coincidir con la del frontend)
        const EMAILJS_CONFIG = {
            serviceId: 'service_3m1zzb7',
            templateIdCustomer: 'template_15du32t',
            templateIdVendor: 'template_2p9q8l6',
            publicKey: 'c7NApXMmxX3q0Faeh'
        };

        // Inicializar EmailJS
        emailjs.init(EMAILJS_CONFIG.publicKey);

        function log(message) {
            console.log(message);
            document.getElementById('status').innerHTML += '<br>' + message;
        }

        async function testEmailJS() {
            log('üîß Iniciando test de EmailJS...');

            // Verificar configuraci√≥n
            log('üìã Configuraci√≥n:');
            log(`- Service ID: ${EMAILJS_CONFIG.serviceId}`);
            log(`- Template Customer: ${EMAILJS_CONFIG.templateIdCustomer}`);
            log(`- Template Vendor: ${EMAILJS_CONFIG.templateIdVendor}`);
            log(`- Public Key: ${EMAILJS_CONFIG.publicKey.substring(0, 10)}...`);

            // Test data
            const testData = {
                to_email: 'a997172483a@hotmail.com',
                customer_name: 'Cliente de Prueba',
                customer_email: 'a997172483a@hotmail.com',
                customer_phone: '987654321',
                customer_dni: '12345678',
                customer_address: 'Direcci√≥n de prueba',
                customer_city: 'Lima',
                order_id: 'ORD-TEST-123',
                payment_date: 'Test Payment Date',
                total_amount: '100.00',
                delivery_address: 'Direcci√≥n de entrega',
                delivery_date: 'Por confirmar',
                special_instructions: 'Ninguna',
                shipping_type: 'Env√≠o a domicilio',
                date_label: 'Fecha de entrega',
                date_value: 'Por confirmar',
                address_label: 'Direcci√≥n de entrega',
                address_value: 'Direcci√≥n de entrega',
                items_list: '‚Ä¢ Ramo de rosas - Cantidad: 1 - Precio: S/ 100.00'
            };

            try {
                log('üìß Intentando enviar email al cliente...');

                const result = await emailjs.send(
                    EMAILJS_CONFIG.serviceId,
                    EMAILJS_CONFIG.templateIdCustomer,
                    testData
                );

                log('‚úÖ ¬°Email enviado exitosamente!');
                log(`üìã Resultado: ${JSON.stringify(result, null, 2)}`);

            } catch (error) {
                log('‚ùå Error enviando email:');
                log(`üìã Error: ${JSON.stringify(error, null, 2)}`);

                // Debug adicional
                if (error.text) {
                    log(`üìù Texto del error: ${error.text}`);
                }
                if (error.status) {
                    log(`üìä Status: ${error.status}`);
                }
            }
        }

        // Auto-test al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            log('‚úÖ P√°gina cargada, EmailJS inicializado');
            log('üëÜ Haz clic en el bot√≥n para probar el env√≠o');
        });
    </script>
</body>
</html>
